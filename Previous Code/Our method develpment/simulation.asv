function [Y,X,R,H]=simulation(N,Tau,Sigma)
clc;
% N=100;
% Tau=0.6;
% Sigma=1;

X=[ones(N,1) normrnd(0,1,N,1)];
p=[0.397,0.208,0.02,0.013,0.018,0.138,0.129,0.054];
R=[ 1.0000    0.8000    0.8000    0.6000    0.6000    0.2000    0.8000    0.6000
    0.8000    1.0000    0.6000    0.8000    0.4000    0.4000    0.6000    0.8000
    0.8000    0.6000    1.0000    0.8000    0.8000    0.4000    0.6000    0.4000
    0.6000    0.8000    0.8000    1.0000    0.6000    0.6000    0.4000    0.6000
    0.6000    0.4000    0.8000    0.6000    1.0000    0.6000    0.4000    0.2000
    0.2000    0.4000    0.4000    0.6000    0.6000    1.0000         0    0.2000
    0.8000    0.6000    0.6000    0.4000    0.4000         0    1.0000    0.8000
    0.6000    0.8000    0.4000    0.6000    0.2000    0.2000    0.8000    1.0000];

Gamma=[1 1];


p=[1 1 1 1];
% R=eye(length(p));


p=p*1/sum(p);
H=mnrnd(2,p,N);
variance=Tau*R;
beta=mvnrnd(zeros(length(R),1),variance);

e=normrnd(0,Sigma,N,1);
Y=X*Gamma'+H*beta+e;

